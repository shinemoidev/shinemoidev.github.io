<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>讯盟 Objective-C 代码规范 | ShineMo iOS Dev</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="对于团队，如果代码风格不统一，阅读或修改同事的代码会非常困难，造成潜在风险。 对于个人，代码规范是对自身编码习惯的一种监督，如果没有这种监督，有时候因为偷懒，会写出难看的代码，时间长了自己都看不懂。这样对于代码的维护是不利的。 每个人写代码都有自己的风格，一份统一的代码规范肯定不能让所有人都感觉非常舒服，但是当我们由个人变成团队，不再是为自己写代码时，请大家尽量遵守大家一起制定的代码规范。">
<meta property="og:type" content="article">
<meta property="og:title" content="讯盟 Objective-C 代码规范">
<meta property="og:url" content="https://shinemoidev.github.io/2018/02/06/2018-02-06-ShineMo-Objective-C-Style-Guid/index.html">
<meta property="og:site_name" content="ShineMo iOS Dev">
<meta property="og:description" content="对于团队，如果代码风格不统一，阅读或修改同事的代码会非常困难，造成潜在风险。 对于个人，代码规范是对自身编码习惯的一种监督，如果没有这种监督，有时候因为偷懒，会写出难看的代码，时间长了自己都看不懂。这样对于代码的维护是不利的。 每个人写代码都有自己的风格，一份统一的代码规范肯定不能让所有人都感觉非常舒服，但是当我们由个人变成团队，不再是为自己写代码时，请大家尽量遵守大家一起制定的代码规范。">
<meta property="og:locale">
<meta property="article:published_time" content="2018-02-06T02:01:35.000Z">
<meta property="article:modified_time" content="2021-12-13T06:44:16.621Z">
<meta property="article:author" content="ShineMo iOS Dev Team">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="其他">
<meta property="article:tag" content="代码规范">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="ShineMo iOS Dev" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ShineMo iOS Dev</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">讯盟iOS开发团队博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://shinemoidev.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2018-02-06-ShineMo-Objective-C-Style-Guid" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/06/2018-02-06-ShineMo-Objective-C-Style-Guid/" class="article-date">
  <time class="dt-published" datetime="2018-02-06T02:01:35.000Z" itemprop="datePublished">2018-02-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%9B%A2%E9%98%9F/">团队</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      讯盟 Objective-C 代码规范
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>对于团队，如果代码风格不统一，阅读或修改同事的代码会非常困难，造成潜在风险。</p>
<p>对于个人，代码规范是对自身编码习惯的一种监督，如果没有这种监督，有时候因为偷懒，会写出难看的代码，时间长了自己都看不懂。这样对于代码的维护是不利的。</p>
<p>每个人写代码都有自己的风格，一份统一的代码规范肯定不能让所有人都感觉非常舒服，但是当我们由个人变成团队，不再是为自己写代码时，请大家尽量遵守大家一起制定的代码规范。</p>
<span id="more"></span>

<h2 id="更新日志"><a href="#更新日志" class="headerlink" title="更新日志"></a>更新日志</h2><p>2017-09-30</p>
<ul>
<li><a href="#fileOrganization">修改文件的组织</a></li>
</ul>
<p>2016-07-27</p>
<ul>
<li><a href="#returnInInit">增加初始化方法中何时return的说明</a></li>
<li><a href="#namingMethods">私有方法命名</a></li>
<li>增加<a href="#todo">TODO</a>格式说明</li>
<li>修改<a href="#namingConstants">命名常量</a>规则</li>
<li>增加<a href="#codeComments">代码注释</a>格式说明</li>
</ul>
<p>2016-07-26</p>
<ul>
<li>增加<a href="#switch">switch</a>的相关约定</li>
<li>增加<a href="#headerFileFormat">.h文件</a>格式</li>
</ul>
<p>2016-07－20</p>
<ul>
<li>增加目录</li>
<li><a href="#if-else-else-format">if-else中else的写法</a></li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a><span id = "reference">参考资料</span></h2><p>本文参考了以下文章，并做了适当修改，以使我们的代码规范能够具有普遍性和适当的个性</p>
<p><a target="_blank" rel="noopener" href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CodingGuidelines/CodingGuidelines.html">Apple’s Cocoa Coding Guidelines</a></p>
<p><a target="_blank" rel="noopener" href="https://google.github.io/styleguide/objcguide.xml?showone=Displaying_Hidden_Details_in_this_Guide#Displaying_Hidden_Details_in_this_Guide">Google’s Open Source Objective-C Style Guid</a></p>
<p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/30ccbaf0f251#">Objective-C编码规范</a></p>
<h2 id="代码格式"><a href="#代码格式" class="headerlink" title="代码格式"></a><span id = "codeFormat">代码格式</span></h2><h3 id="空格和制表符Tab"><a href="#空格和制表符Tab" class="headerlink" title="空格和制表符Tab"></a><span id = "spaceAndTab">空格和制表符Tab</span></h3><p>只能使用空格来缩进，任何情况下都不要使用制表符Tab。在<em>Xcode &gt; Preference &gt; Text Editing</em>中将Tab和自动缩进都设置为4个空格。</p>
<h3 id="行最大长度"><a href="#行最大长度" class="headerlink" title="行最大长度"></a><span id = "lineMaxLength">行最大长度</span></h3><p>普遍来讲，代码行最大长度为80个字符，即每行代码包括缩进的空格在内不能多于80个字符。由于Objective-C特殊的语法，此处规定代码行最大长度为120个字符，可以在<em>Xcode &gt; Preferences &gt; Text Editing &gt; Page guid at column: 120</em>中设置。</p>
<h3 id="方法的书写"><a href="#方法的书写" class="headerlink" title="方法的书写"></a><span id = "methodStyle">方法的书写</span></h3><p>在每个方法的定义前留白一行，也就是在方法和方法之间留空一行。</p>
<p>一个典型的Objective-C方法看起来应该是这样的：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)doSomethingWithString:(<span class="built_in">NSString</span> *)theString &#123;</span><br><span class="line">    <span class="comment">//...do anything you want</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>-</code> / <code>+</code> 和返回值 <code>(void)</code> 之间应该有一个空格。而 <code>(void)</code> 之后没有空格。第一个大括号 <code>&#123;</code> 在函数名所在行的末尾，与最后一个参数之间有一个空格。</p>
<p>如果一个函数有很多参数或者名字很长，应该以 <code>:</code> 为基准多行对齐显示：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)doSomethingWithFoo:(SMTFoo *)theFoo</span><br><span class="line">                      rect:(<span class="built_in">CGRect</span>)theRect</span><br><span class="line">                  interval:(<span class="built_in">NSTimInterval</span>)theInterval &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分行时，如果第一段名字过短，后续名称应该以4个空格为单位进行缩进：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)shortFoo:(SMTFoo *)theFoo</span><br><span class="line">    	  longKeyword:(<span class="built_in">CGRect</span>)theRect</span><br><span class="line">	evenLongerKeyword:(<span class="built_in">NSTimeInterval</span>)theInterval</span><br><span class="line">                error:(<span class="built_in">NSError</span> **)error &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方法调用"><a href="#方法调用" class="headerlink" title="方法调用"></a><span id = "methodInvocation">方法调用</span></h3><p>函数调用和书写的格式差不多，可以按照函数的长短来选择写在一行或者分成多行。</p>
<p>写在一行：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> doFooWithName:arg1 age:arg2 error:arg3];</span><br></pre></td></tr></table></figure>

<p>分行写，按 <em>:</em> 对齐：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> doFooWithName:arg1</span><br><span class="line">                age:arg2</span><br><span class="line">              error:arg3];</span><br></pre></td></tr></table></figure>

<p>以下写法是错误的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// some lines with &gt;1 arg</span></span><br><span class="line">[<span class="keyword">self</span> doFooWithName:arg1 age:arg2</span><br><span class="line">              error:arg3];</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span> doFooWithName:arg1</span><br><span class="line">                age:arg2 error:arg3];</span><br><span class="line"></span><br><span class="line"><span class="comment">// aligning keywords instead of colons</span></span><br><span class="line">[<span class="keyword">self</span> doFooWithName:arg1</span><br><span class="line">      age:arg2</span><br><span class="line">      error:arg3];</span><br></pre></td></tr></table></figure>

<p>如果函数第一段较短，则以最长的一段左侧缩进4个空格为准，<code>:</code> 对齐：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> shortFoo:arg1</span><br><span class="line">                longKeyword:arg2</span><br><span class="line">    evenLongerLongerKeyword:arg3</span><br><span class="line">                      error:&amp;arg4];</span><br></pre></td></tr></table></figure>

<h3 id="h文件"><a href="#h文件" class="headerlink" title=".h文件"></a><span id = "headerFileFormat">.h文件</span></h3><p>从上到下依次包括</p>
<p>.h文件中主要包括 _FOUNDATION_EXPORT部分_、 _@class部分_、 _typedef部分_、 _@protocol部分_、 _@interface部分_。每部分之间应该有一个空行。如果包含多个 _typedef_，则每个 <em>typedef</em> 之间应该有一个空行。在 <em>@interface</em> 中，有上到下依次为 _@property部分_、 _类方法部分_、 _实例方法部分_。</p>
<p><strong>注意栗子中的空行！！！</strong></p>
<p>栗子</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;lib1.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;lib2.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">WDClass1</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">WDClass2</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果有宏定义的话，在此位置</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MACRONAME1 expression1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MACRONAME2 expression2</span></span><br><span class="line"></span><br><span class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> *<span class="keyword">const</span> kWDGlobalVar1;</span><br><span class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> *<span class="keyword">const</span> kWDGlobalVar2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, WDEnum1) &#123;</span><br><span class="line">    WDEnum1Case0,</span><br><span class="line">    WDEnum1Case1,</span><br><span class="line">    WDEnum1Case2,</span><br><span class="line">    WDEnum1Case3,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, WDEnum2) &#123;</span><br><span class="line">    WDEnum2Case0,</span><br><span class="line">    WDEnum2Case1,</span><br><span class="line">    WDEnum2Case2,</span><br><span class="line">    WDEnum2Case3,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WDClass</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *var1;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> var2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是变量的注释</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSObject</span> *object;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)classMethodName;</span><br><span class="line">- (<span class="built_in">NSString</span> *)instanceMethodName1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是方法的注释</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)instanceMethodName2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a><span id = "blocks">Blocks</span></h2><p>根据block的长度，有不同的书写规则：</p>
<ul>
<li><p>不论block多短，就算是一行能放得下，也要分行写</p>
</li>
<li><p>如果分行显示的话，block的右括号 <code>&#125;</code> 应该和调用block那行代码的第一个非空字符对齐</p>
</li>
<li><p>Block内始终以4个空格缩进</p>
</li>
<li><p>如果block过于庞大，比如说多于20行，应该单独声明成一个变量来使用</p>
</li>
<li><p><code>^</code> 和 <code>(</code> 之间，<code>^</code> 和 <code>&#123;</code> 之间都没有空格，参数列表的右括号 <code>)</code> 和 <code>&#123;</code> 之间有一个空格</p>
</li>
</ul>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Though the entire block can fit on one line, do a wrapping.</span></span><br><span class="line"><span class="comment">// The block can be put on a new line, indented four spaces, with the</span></span><br><span class="line"><span class="comment">// closing brace aligned with the first character of the line on which</span></span><br><span class="line"><span class="comment">// block was declared.</span></span><br><span class="line">[operation doSomethingWithCompletionHandler:^&#123;</span><br><span class="line">	[<span class="keyword">self</span> onOperationDone];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using a block with a C API follows the same alignment and spacing</span></span><br><span class="line"><span class="comment">// rules as with Objective-C.</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(myQueue, ^&#123;</span><br><span class="line">	<span class="comment">// do what you want</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// An example where the parameter wraps and the block declaration fits</span></span><br><span class="line"><span class="comment">// on the same line. Note the spacing of |^(SessionWindow *window) &#123;|</span></span><br><span class="line"><span class="comment">// compared to |^&#123;| above.</span></span><br><span class="line">[[SessionService sharedService]</span><br><span class="line">	loadWindowWithCompletionBlock:^(SessionWindow *window) &#123;</span><br><span class="line">        <span class="keyword">if</span> (window) &#123;</span><br><span class="line">          [<span class="keyword">self</span> windowDidLoad:window];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          [<span class="keyword">self</span> errorLoadingWindow];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// An example where the parameter wraps and the block declaration does</span></span><br><span class="line"><span class="comment">// not fit on the same line as the name.</span></span><br><span class="line">[[SessionService sharedService]</span><br><span class="line">    loadWindowWithCompletionBlock:</span><br><span class="line">        ^(SessionWindow *window) &#123;</span><br><span class="line">            <span class="keyword">if</span> (window) &#123;</span><br><span class="line">              [<span class="keyword">self</span> windowDidLoad:window];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              [<span class="keyword">self</span> errorLoadingWindow];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Large blocks can be declared out-of-line.</span></span><br><span class="line"><span class="keyword">void</span> (^largeBlock)(<span class="keyword">void</span>) = ^&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line">[_operationQueue addOperationWithBlock:largeBlock];</span><br><span class="line"></span><br><span class="line"><span class="comment">// An example with multiple inlined blocks in one invocation.</span></span><br><span class="line">[myObject doSomethingWith:arg1</span><br><span class="line">               firstBlock:^(Foo *a) &#123;</span><br><span class="line">                   <span class="comment">// ...</span></span><br><span class="line">               &#125;</span><br><span class="line">               secondBlock:^(Bar *b) &#123;</span><br><span class="line">                   <span class="comment">// ...</span></span><br><span class="line">               &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h2 id="NSArray-NSDictionary语法糖"><a href="#NSArray-NSDictionary语法糖" class="headerlink" title="NSArray/NSDictionary语法糖"></a><span id = "arrayAndDic">NSArray/NSDictionary语法糖</span></h2><p>应该用可读性更好的语法糖来构造 <code>NSArray</code> 和 <code>NSDictionary</code> 等数据结构，避免使用冗长的 <code>alloc</code>, <code>init</code> 方法。</p>
<p>如果构造代码写在一行，不需要在括号两端留空格：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = @[[foo description], <span class="string">@&quot;Another String&quot;</span>, [bar description]];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;<span class="built_in">NSForegroundColorAttributeName</span>: [<span class="built_in">NSColor</span> redColor]&#125;;</span><br></pre></td></tr></table></figure>

<p><em>不需要留空格</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = @[ [foo description], <span class="string">@&quot;Another String&quot;</span>, [bar description] ];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123; <span class="built_in">NSForegroundColorAttributeName</span> : [<span class="built_in">NSColor</span> redColor] &#125;;</span><br></pre></td></tr></table></figure>

<p>如果构造代码不写在一行内，构造元素同样使用 <em>4个空格</em> 来进行缩进，右括号 <code>]</code> 或者 <code>&#125;</code> 写在新的一行，并且与声明代码的第一行第一个非空字符对齐：</p>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = @[</span><br><span class="line">	<span class="string">@&quot;This&quot;</span>,</span><br><span class="line">	<span class="string">@&quot;is&quot;</span>,</span><br><span class="line">	<span class="string">@&quot;an&quot;</span>,</span><br><span class="line">	<span class="string">@&quot;array&quot;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dictionary = @&#123;</span><br><span class="line">	<span class="built_in">NSFontAttributeName</span>: [<span class="built_in">NSFont</span> fontWithName:<span class="string">@&quot;Helvetica-Bold&quot;</span> size:<span class="number">12</span>],</span><br><span class="line">	<span class="built_in">NSForegroundColorAttributeName</span>: fontColor</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Don&#x27;t need to add spaces to align the params</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *option2 = @&#123;</span><br><span class="line">  <span class="built_in">NSFontAttributeName</span> :            [<span class="built_in">NSFont</span> fontWithName:<span class="string">@&quot;Arial&quot;</span> size:<span class="number">12</span>],</span><br><span class="line">  <span class="built_in">NSForegroundColorAttributeName</span> : fontColor</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>严禁再使用以下方法初始化NSArray/NSDictionary</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@&quot;obj1&quot;</span>, <span class="string">@&quot;obj2&quot;</span>, <span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:...nil];</span><br></pre></td></tr></table></figure>

<p>构造NSArray时使用 <code>&lt;&gt;</code> 语法表明元素类型</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span>&lt;WdOrgUser *&gt; *users;</span><br></pre></td></tr></table></figure>

<h2 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a><span id = "namingRules">命名规范</span></h2><h3 id="基本原则"><a href="#基本原则" class="headerlink" title="基本原则"></a><span id = "namingBasic">基本原则</span></h3><p>采用<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%A7%9D%E5%B3%B0%E5%BC%8F%E5%A4%A7%E5%B0%8F%E5%AF%AB">驼峰命名法</a></p>
<h4 id="清晰"><a href="#清晰" class="headerlink" title="清晰"></a><span id = "namingClear">清晰</span></h4><p>命名应该尽可能的清晰和简洁，但在Objective-C中，<strong>清晰比简洁更重要</strong>。由于Xcode强大的自动补全功能，我们不必担心名称过长的问题。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">insertObject:atIndex:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，insert的对象类型和at的位置属性都没有说明</span></span><br><span class="line">insert:at:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">removeObjectAtIndex:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，remove的对象类型没有说明，参数的作用没有说明</span></span><br><span class="line">remove:</span><br></pre></td></tr></table></figure>

<p>不要使用单词的简写，拼写出完整的单词：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">destinationSelection</span><br><span class="line">setBackgroundColor:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，不要使用简写</span></span><br><span class="line">destSel</span><br><span class="line">setBkgdColor:</span><br></pre></td></tr></table></figure>

<p>然而，有部分单词简写在Objective-C编码过程中非常常用，以至于成为了一种规范，这些简写可以在代码中直接使用，下面列举了部分：</p>
<table>
<thead>
<tr>
<th align="left">全拼</th>
<th align="left">简写</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Allocate</td>
<td align="left">alloc</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Alternate</td>
<td align="left">alt</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Application</td>
<td align="left">app</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Calculate</td>
<td align="left">calc</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Deallocate</td>
<td align="left">dealloc</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Function</td>
<td align="left">func</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Horizontal</td>
<td align="left">horiz</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Vertical</td>
<td align="left">vert</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Information</td>
<td align="left">info</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Initialize</td>
<td align="left">init</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Integer</td>
<td align="left">int</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Maximum</td>
<td align="left">max</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Minimum</td>
<td align="left">min</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Message</td>
<td align="left">msg</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Interface Builder Archive</td>
<td align="left">nib</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Pasteboard</td>
<td align="left">pboard</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Rectangle</td>
<td align="left">rect</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">Temporary</td>
<td align="left">temp</td>
<td align="center">不要再写tmp了！</td>
</tr>
<tr>
<td align="left">Representation</td>
<td align="left">Rep</td>
<td align="center">used in class name such as <em>NSBitmapImageRep</em></td>
</tr>
</tbody></table>
<p>命名方法或者函数时要避免歧义</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有歧义，是返回一个sendPort还是send一个port？</span></span><br><span class="line">sendPort</span><br><span class="line"></span><br><span class="line"><span class="comment">// 有歧义，是返回一个名字属性的值还是display一个name的动作？</span></span><br><span class="line">displayName</span><br></pre></td></tr></table></figure>

<h4 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a><span id = "namingConsistency">一致性</span></h4><p>整个工程的命名风格要保持一致性，最好和苹果SDK的代码保持统一。不同类中完成相似功能的方法应该叫一样的名字，比如我们总是用 <code>count</code> 来返回集合的个数，不能在A类中使用 <code>count</code> 而在B类中使用 <code>getNumber</code>。</p>
<h4 id="使用前缀"><a href="#使用前缀" class="headerlink" title="使用前缀"></a><span id = "namingPrefix">使用前缀</span></h4><p>如果代码需要打包成Framework给别的工程使用，或者工程项目非常庞大，需要拆分成不同的模块，使用命名前缀是非常有用的。</p>
<ul>
<li><p>前缀由大写字母缩写组成，比如Cocoa中的 <code>NS</code> 前缀代表Foundation框架中的类，<code>IB</code> 则代表Interface Builder框架。</p>
</li>
<li><p>可以在为类、协议、函数、常量以及typedef宏命名的时候使用前缀，但注意不要为成员变量或者方法使用前缀，因为他们本身就包括在类的命名空间中。</p>
</li>
<li><p>命名前缀的时候不要和苹果SDK框架冲突。</p>
</li>
<li><p>推荐使用三个大写字母的前缀，比如SHM(ShineMo)。</p>
</li>
</ul>
<h3 id="命名类和协议（Class-amp-Protocol）"><a href="#命名类和协议（Class-amp-Protocol）" class="headerlink" title="命名类和协议（Class&amp;Protocol）"></a><span id = "namingClassAndProtocol">命名类和协议（Class&amp;Protocol）</span></h3><p>类名以大写字母开头，应该包含一个 <em>名词</em> 来表示它代表的对象类型，同时可以加上必要的前缀，比如 <code>NSString</code>, <code>NSDate</code>, <code>NSScanner</code>, <code>NSApplication</code> 等等</p>
<p>而协议名称应该清晰地表示它所执行的行为，而且要和类名区别开来，所以通常使用 <em>ing</em> 词尾来命名一个协议， 比如 <code>NSCopying</code>, <code>NSLocking</code>。</p>
<p>有些协议本身包含了很多不相关的功能，主要用来为某一特定类服务，这时候可以直接用类名来命名这个协议，比如 <code>NSObject</code> 协议，它包含了id对象在生存周期内的一系列方法。</p>
<h3 id="命名头文件（Headers）"><a href="#命名头文件（Headers）" class="headerlink" title="命名头文件（Headers）"></a><span id = "namingHeaders">命名头文件（Headers）</span></h3><p>源码的头文件名应该清晰地暗示它的功能和包含的内容：</p>
<ul>
<li><p>如果头文件内定义了类或者协议，直接用类名或者协议名来命名头文件，比如 <code>NSLocal.h</code> 定义了 <code>NSLocal</code> 类</p>
</li>
<li><p>如果头文件内定义了一系列的类、协议、类别，使用其中最主要的类名来命名头文件，比如 <code>NSString.h</code> 定义了 <code>NSString</code> 和 <code>NSMutableString</code></p>
</li>
<li><p>每一个Framework都应该有一个和框架同名的头文件，包含了框架中所有公共类头文件的引用，比如 <code>Foundation.h</code></p>
</li>
<li><p>Framework中有时候会实现在别的框架中类的类别扩展，这样的文件通常使用 <em>被扩展</em> + <em>Additions</em> 的方式来命名，比如 <code>NSBundle + Additions.h</code></p>
</li>
</ul>
<h3 id="命名方法（Methods）"><a href="#命名方法（Methods）" class="headerlink" title="命名方法（Methods）"></a><span id = "namingMethods">命名方法（Methods）</span></h3><p>Objective-C的方法名通常都比较长，这是为了让程序有更好地可读性，按照苹果的说法『好的方法名应该可以以一个句子的形式朗读出来』</p>
<p>方法一般以小写字母打头，每一个后续的单词首字母大写，方法名中不应该有标点符号（包括下划线），有两个例外：</p>
<ul>
<li>可以用一些通用的大写字母缩写打头方法，比如 <em>PDF</em>, <em>TIFF</em> 等</li>
<li>可以用带下划线的前缀来命名类别中的方法，比如类别中的方法使用 <em>shm_</em> 或者 <em>wd_</em> 开头</li>
</ul>
<p>私有方法 <strong>不需要</strong> 加 <em>p_</em> 或者 <em>_</em> 前缀</p>
<p>如果方法表示让对象执行一个动作，使用动词打头的命名，注意不要使用 <em>do</em>, <em>does</em> 这种多余的关键字，动词本身的暗示就足够了：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动词打头的方法表示让对象执行一个动作</span></span><br><span class="line">- (<span class="keyword">void</span>)invokeWithTarget:(<span class="keyword">id</span>)target;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)selectTabViewItem:(<span class="built_in">NSTabViewItem</span> *)tabViewItem;</span><br></pre></td></tr></table></figure>

<p>如果方法是为了获取对象的一个属性值，直接用属性名称来命名这个方法，注意不要添加 <em>get</em> 或者其他的动词前缀：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，使用属性名来命名方法</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)cellHeight;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，添加了多余的动词前缀</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)calcCellHeight;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)getCellHeight;</span><br></pre></td></tr></table></figure>

<p>对于有多个参数的方法，务必在每一个参数前都添加关键词，关键词应当清晰说明参数的作用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，保证每个参数都有关键词修饰</span></span><br><span class="line">- (<span class="keyword">void</span>)sendAction:(SEL)aSelector toObject:(<span class="keyword">id</span>)anObject forAllCells:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，遗漏关键词</span></span><br><span class="line">- (<span class="keyword">void</span>)sendAction:(SEL)aSelector :(<span class="keyword">id</span>)anObject :(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="keyword">id</span>)viewWithTag:(<span class="built_in">NSInteger</span>)aTag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，关键词的作用不清晰</span></span><br><span class="line">- (<span class="keyword">id</span>)taggedView:(<span class="keyword">int</span>)aTag;</span><br></pre></td></tr></table></figure>

<p>不要用 <em>and</em> 来连接两个参数， 通常 <em>and</em> 用来表示方法执行了两个相对独立的操作（从设计上来说，这时候应该拆分成两个独立的方法）：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误，不要用『and』来连接参数</span></span><br><span class="line">- (<span class="keyword">int</span>)runModalForDirectory:(<span class="built_in">NSString</span> *)path andFile:(<span class="built_in">NSString</span> *)name andTypes:(<span class="built_in">NSArray</span> *)fileTypes;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确，使用『and』来表示两个相对独立的操作</span></span><br><span class="line">- (<span class="keyword">int</span>)openFile:(<span class="built_in">NSString</span> *)fullPath withApplication:(<span class="built_in">NSString</span> *)appName andDeactivate:(<span class="built_in">BOOL</span>)flag;</span><br></pre></td></tr></table></figure>

<p>方法的参数命名也有一些需要注意的地方：</p>
<ul>
<li><p>和方法名类似，参数的第一个字母小写，后面的每一个单词首字母大写</p>
</li>
<li><p>不要在方法中使用类似 <em>pointer</em>, <em>ptr</em> 这样的字眼去表示指针，参数本身的类型足以说明</p>
</li>
<li><p>不要使用只有一两个字母的参数名</p>
</li>
<li><p>不要使用简写，拼出完整的单词</p>
</li>
</ul>
<p>下面列举了一些常用参数名：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...action:(SEL)aSelector</span><br><span class="line">...alignment:(<span class="keyword">int</span>)mode</span><br><span class="line">...atIndex:(<span class="keyword">int</span>)index</span><br><span class="line">...content:(<span class="built_in">CGRect</span>)aRect</span><br><span class="line">...doubleValue:(<span class="keyword">double</span>)aDouble</span><br><span class="line">...floatValue:(<span class="keyword">float</span>)aFloat</span><br><span class="line">...font:(<span class="built_in">UIFont</span> *)font</span><br><span class="line">...frame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">...intValue:(<span class="keyword">int</span>)anInt</span><br><span class="line">...keyEquivalent:(<span class="built_in">NSString</span> *)charCode</span><br><span class="line">...length:(<span class="keyword">int</span>)length</span><br><span class="line">...point:(<span class="built_in">CGPoint</span>)point</span><br><span class="line">...stringValue:(<span class="built_in">NSString</span> *)aString</span><br><span class="line">...tag:(<span class="keyword">int</span>)tag</span><br><span class="line">...target:(<span class="keyword">id</span>)anObject</span><br><span class="line">...title:(<span class="built_in">NSString</span> *)aString</span><br></pre></td></tr></table></figure>

<h3 id="存取方法（Accessor-Methods）"><a href="#存取方法（Accessor-Methods）" class="headerlink" title="存取方法（Accessor Methods）"></a><span id = "namingAccessorMethods">存取方法（Accessor Methods）</span></h3><p>存取方法是指用来获取和设置类属性值的方法，属性的不同类型，对应不同的存取方法规范：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 属性是一个名词时的存取方法范式</span></span><br><span class="line">- (type)noun;</span><br><span class="line">- (<span class="keyword">void</span>)setNoun:(type)aNoun;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 栗子</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)title;</span><br><span class="line">- (<span class="keyword">void</span>)setTitle:(<span class="built_in">NSString</span> *)aTitle;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性是一个形容词时的存取方法的范式</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isAdjective;</span><br><span class="line">- (<span class="keyword">void</span>)setAdjective:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 栗子</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isEditable;</span><br><span class="line">- (<span class="keyword">void</span>)setEditable:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性是一个动词时存取方法的范式</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)verbObject;</span><br><span class="line">- (<span class="keyword">void</span>)setVerbObject:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 栗子</span></span><br><span class="line">- (<span class="keyword">void</span>)showsAlpha;</span><br><span class="line">- (<span class="keyword">void</span>)setShowsAlpha:(<span class="built_in">BOOL</span>)flag</span><br></pre></td></tr></table></figure>

<p>命名存取方法时不要将动词转化为被动形式来使用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="keyword">void</span>)setAcceptsGlyphInfo:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)acceptsGlyphInfo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要使用动词的被动形式</span></span><br><span class="line">- (<span class="keyword">void</span>)setGlyphInfoAccepted:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)glyphInfoAccepted;</span><br></pre></td></tr></table></figure>

<p>可以使用 <em>can</em>, <em>should</em>, <em>will</em> 等词来协助表达存取方法的意思，但是不要使用 <em>do</em> 和 <em>does</em> :</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="keyword">void</span>)setCanHide:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)canHide;</span><br><span class="line">- (<span class="keyword">void</span>)setShouldCloseDocument:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)shouldCloseDocument;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要使用『do』或者『does』</span></span><br><span class="line">- (<span class="keyword">void</span>)setDoesAcceptGlyphInfo:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)doesAcceptGlyphInfo;</span><br></pre></td></tr></table></figure>

<p>为什么Objective-C中不适用 <em>get</em> 前缀来表示属性获取方法？因为 <em>get</em> 在Objective-C中通常只用来表示从函数指针返回值的函数：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 三个参数都是作为函数的返回值来使用，这样的函数名可以使用『get』前缀</span></span><br><span class="line">- (<span class="keyword">void</span>)getLineDash:(<span class="keyword">float</span> *)pattern count:(<span class="keyword">int</span> *)count phase:(<span class="keyword">float</span> *)phase;</span><br></pre></td></tr></table></figure>

<h3 id="命名委托（Delegate）"><a href="#命名委托（Delegate）" class="headerlink" title="命名委托（Delegate）"></a><span id = "namingDelegate">命名委托（Delegate）</span></h3><p>当特定的事件发生时，对象会触发它注册的委托方法。委托是Objective-C中常用的传递消息的方式。委托有它固定的命名范式。</p>
<p>一个委托方法的第一个参数是触发它的对象，第一个关键词是触发对象的类名，除非委托方法只有一个名为 <code>sender</code> 的参数：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个关键词为触发委托的类名</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">NSApplication</span> *)sender openFile:(<span class="built_in">NSString</span> *)filename;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当只有一个『sender』参数时可用省略类名</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)applicationOpenUntitledFile:(<span class="built_in">NSApplication</span> *)sender;</span><br></pre></td></tr></table></figure>

<p>根据委托方法触发的时机和目的，使用 <em>should</em>, <em>will</em>, <em>did</em> 等关键词</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)browserDidScroll:(<span class="built_in">NSBrowser</span> *)sender;</span><br><span class="line">- (<span class="built_in">NSUndoManager</span> *)windowWillReturnUndoManager:(<span class="built_in">NSWindow</span> *)window;</span><br><span class="line">- (<span class="built_in">BOOL</span>)windowShouldClose:(<span class="keyword">id</span>)sender;</span><br></pre></td></tr></table></figure>

<h3 id="集合类操作方法（Collection-Methods）"><a href="#集合类操作方法（Collection-Methods）" class="headerlink" title="集合类操作方法（Collection Methods）"></a><span id = "namingCollectionMethods">集合类操作方法（Collection Methods）</span></h3><p>有些对象管理着一系列其它对象或者元素的集合，需要使用类似『增删改查』的方法来对集合进行操作，这些方法的命名范式一般为：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 集合操作范式</span></span><br><span class="line">- (<span class="keyword">void</span>)addElement:(elementType)anObj;</span><br><span class="line">- (<span class="keyword">void</span>)removeElement:(elementType)anObj;</span><br><span class="line">- (<span class="built_in">NSArray</span> *)elements;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 栗子</span></span><br><span class="line">- (<span class="keyword">void</span>)addLayoutManager:(<span class="built_in">NSLayoutManager</span> *)obj;</span><br><span class="line">- (<span class="keyword">void</span>)removeLayoutManger:(<span class="built_in">NSLayoutManager</span> *)obj;</span><br><span class="line">- (<span class="built_in">NSArray</span> *)layoutManagers;</span><br></pre></td></tr></table></figure>

<p>注意，如果返回的集合是无序的，优先使用 <code>NSSet</code> 来代替 <code>NSArray</code> 。如果需要将元素插入到特定的位置，使用类似于这样的命名：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)insertLayoutManager:(<span class="built_in">NSLayoutManager</span> *)obj atIndex:(<span class="keyword">int</span>)index;</span><br><span class="line">- (<span class="keyword">void</span>)removeLayoutMangerAtIndex:(<span class="keyword">int</span>)index;</span><br></pre></td></tr></table></figure>

<p>如果管理的集合元素中有指向管理对象的指针，要设置成 <code>weak</code> 类型以防止引用循环。</p>
<h3 id="命名函数（Functions）"><a href="#命名函数（Functions）" class="headerlink" title="命名函数（Functions）"></a><span id = "namingFunctions"><del>命名函数（Functions）</del></span></h3><blockquote>
<p>我也不是很清楚这一段到底说的啥，大家扫一眼就就好了</p>
</blockquote>
<p>在很多场合仍然需要用到函数，比如说如果一个对象是单例，那么应该使用函数来代替类方法执行相关操作。</p>
<p>函数的命名和方法有一些不同，主要是：</p>
<ul>
<li><p>函数名称一般带有缩写前缀，表示方法所在的框架</p>
</li>
<li><p>前缀后的单词以『驼峰』表示法显示，第一个单词首字母大写</p>
</li>
</ul>
<p>函数名的第一个单词通常是一个动词，表示方法执行的操作：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSHighlightRect</span></span><br><span class="line"><span class="built_in">NSDeallocateObject</span></span><br></pre></td></tr></table></figure>

<p>如果函数返回其参数的某个属性值，省略动词：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="built_in">NSEventMaskFromType</span>(<span class="built_in">NSEventType</span> type)</span><br><span class="line"><span class="keyword">float</span> <span class="built_in">NSHeight</span>(<span class="built_in">NSRect</span> aRect)</span><br></pre></td></tr></table></figure>

<p>如果函数通过指针参数来返回值，需要在函数名中使用 <em>Get</em> ：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">NSGetSizeAndAlignment</span>(<span class="keyword">const</span> <span class="keyword">char</span> *typePtr, <span class="keyword">unsigned</span> <span class="keyword">int</span> *sizep, <span class="keyword">unsigned</span> <span class="keyword">int</span> *alignp)</span><br></pre></td></tr></table></figure>

<p>函数的返回类型是BOOL时的命名：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> <span class="built_in">NSDecimalIsNotANumber</span>(<span class="keyword">const</span> <span class="built_in">NSDecimal</span> *decimal)</span><br></pre></td></tr></table></figure>

<h3 id="命名属性和实例变量（Properties-amp-Instance-Variables）"><a href="#命名属性和实例变量（Properties-amp-Instance-Variables）" class="headerlink" title="命名属性和实例变量（Properties&amp;Instance Variables）"></a><span id = "namingVars">命名属性和实例变量（Properties&amp;Instance Variables）</span></h3><p><strong>*</strong> 的位置与类型之间有一个空格，与变量名之间没有空格。即 <strong>*</strong> 紧跟在变量名前。</p>
<p>属性和对象的存取方法相关联，属性的第一个字母小写，后续单词首字母大写，不必添加前缀。属性按功能命名成名词或者动词：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 名词属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>) <span class="built_in">NSString</span> *title;</span><br><span class="line"><span class="comment">// 动词属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsAlpha;</span><br></pre></td></tr></table></figure>

<p>属性也可以命名成形容词，这时候通常会指定一个带有 <em>is</em> 前缀的get方法来提高可读性：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">getter</span>=isEditable) <span class="built_in">BOOL</span> editable;</span><br></pre></td></tr></table></figure>

<p>命名实例变量，在变量名前加上 <em>_</em> 前缀（有些有历史的代码会将 <em>_</em> 放在后面），其它和命名属性一样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@implementation MyClass &#123;</span><br><span class="line">    BOOL _showsTitle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一般来说，类需要对使用者隐藏数据存储的细节，所以不要将实例方法定义成公共可访问的接口，可以使用 <code>@private</code>, <code>@protected</code> 前缀</p>
<p>如果一个变量需要暴露给外部使用，则需要在.h文件中声明为<code>@property</code>；</p>
<p>如果一个变量不需要暴露给外部使用，则在.m文件中声明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@implementation SMTContactsDataService &#123;</span><br><span class="line">    NSString *_myUid;</span><br><span class="line">    NSString *_loginMobile;</span><br><span class="line">    NSArray *_loginUserOrgIds;</span><br><span class="line">    NSDictionary *_orgVersion;</span><br><span class="line">    int64_t _favouritContactsVersion;</span><br><span class="line">    int64_t _publicServiceVersion;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>按照苹果的说法，不建议在除了 <code>init</code>, <code>dealloc</code>, <code>setter</code>, <code>getter</code> 方法以外的地方直接访问实例变量，但很多人认为直接访问会让代码更加清晰可读，只在需要计算或者执行操作的时候才使用存取方法访问。但是有时候我们会通过重写 <code>getter</code> 和 <code>setter</code> 方法来做一些额外的事。所以此处建议遵循苹果的建议。</p>
<h3 id="命名常量（Constants）"><a href="#命名常量（Constants）" class="headerlink" title="命名常量（Constants）"></a><span id = "namingConstants">命名常量（Constants）</span></h3><p>常量名字应该以小写字母 <em>k</em> 开头，<em>k</em> 之后的第一个字母大写，遵循驼峰命名法。</p>
<p>如果常量需要提供给全局使用，需要 <em>k</em> 之后接 <em>WD</em> 再接 <em>ClassName</em> 再接变量名字</p>
<p>栗子</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> kNumberOfFiles = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">WDLogin.h</span><br><span class="line"></span><br><span class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> *<span class="keyword">const</span> kWDLoginDoLoginNotification;</span><br><span class="line"></span><br><span class="line">WDLogin.m</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> kWDLoginDoLoginNotification = <span class="string">@&quot;doLoginNotification&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果要定义一组相关的常量，尽量使用枚举类型（enumerations），枚举类型的命名规则和函数的命名规则相同。建议使用 <code>NS_ENUM</code> 和 <code>NS_OPTIONS</code> 宏来定义枚举类型：</p>
<p><em>定义一个枚举</em></p>
<p>一定要指定起始值</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, WDMatrixMode) &#123;</span><br><span class="line">    WDMatrixModeRadio = <span class="number">0</span>,</span><br><span class="line">    WDMatrixModeHighlight,</span><br><span class="line">    WDMatrixModeList,</span><br><span class="line">    WDMatrixModeTrack,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><em>定义bit map</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, WDWindowMask) &#123;</span><br><span class="line">    WDWindowMaskBorderless      = <span class="number">0</span>,</span><br><span class="line">    WDWindowMaskTitle           = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">    WDWindowMaskClosable        = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">    WDWindowMaskMiniaturizable  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">    WDWindowMaskResizable       = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>尽量保持 <em>=</em> 对齐</p>
<p>使用 <code>const</code> 定义浮点型或者单个的整数型常量，如果要定义一组相关的整数常量，应该优先使用枚举。常量的命名规范和函数相同：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">float</span> <span class="built_in">NSLightGray</span>;</span><br></pre></td></tr></table></figure>

<p>不要使用 <code>#define</code> 宏来定义常量，如果是整型常量，尽量使用枚举，浮点型常量，使用 <code>const</code> 定义。<code>#define</code> 通常用来给编译器决定是否编译某块代码，比如常用的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br></pre></td></tr></table></figure>

<p>注意到一般由编译器定义的宏会在前后都有两个 <code>_</code> ，即前后都有一个 <code>__</code> , 比如 <code>__MACH__</code></p>
<h3 id="命名通知（Notifications）"><a href="#命名通知（Notifications）" class="headerlink" title="命名通知（Notifications）"></a><span id = "namingNotifications">命名通知（Notifications）</span></h3><p>通知常用于在模块间传递消息，所以通知要尽可能地表示出发生的事件，通知的命名范式是：</p>
<blockquote>
<p>[触发通知的类名] + [Did | Will] | [动作] + Notification</p>
</blockquote>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSApplicationDidBecomeActiveNotification</span></span><br><span class="line"><span class="built_in">NSWindowDidMiniaturizeNotification</span></span><br><span class="line"><span class="built_in">NSTextViewDidChangeSelectionNotification</span></span><br><span class="line"><span class="built_in">NSColorPanelColorDidChangeNotification</span></span><br></pre></td></tr></table></figure>

<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a><span id = "comments">注释</span></h2><p>读没有注释代码是很痛苦的，好的注释不仅能让人轻松读懂你的程序，还能提升代码的逼格。注意注释是为了让别人看懂，而不是仅仅让你自己看懂。</p>
<h3 id="文件注释"><a href="#文件注释" class="headerlink" title="文件注释"></a><span id = "fileComments">文件注释</span></h3><p>每个文件都应该写文件注释，文件注释通常包含</p>
<ul>
<li><p>文件所在模块</p>
</li>
<li><p>作者信息</p>
</li>
<li><p>历史版本信息</p>
</li>
<li><p>版权信息</p>
</li>
<li><p>文件包含的内容、作用</p>
</li>
</ul>
<h3 id="代码注释"><a href="#代码注释" class="headerlink" title="代码注释"></a><span id = "codeComments">代码注释</span></h3><p>好的代码应该是『自解释』（self-documenting）的，但仍然需要详细的注释来说明参数的意义，返回值、功能以及可能的副作用。</p>
<p>方法、函数、类、协议、类别的定义都需要注释，推荐采用Apple的标准注释风格，好处是可以在引用的地方 <em>alt+点击</em> 自动弹出注释，非常方便。</p>
<p>推荐使用<a target="_blank" rel="noopener" href="https://github.com/onevcat/VVDocumenter-Xcode">VVDocumenter</a>自动生成注释</p>
<p>协议、委托的注释要明确说明其被触发的条件：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Delegate - Sent when failed to init connection, like p2p failed.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)initConnectionDidFailed:(IPCConnectionHandler *)handler;</span><br></pre></td></tr></table></figure>

<p>如果在注释中要引用参数名或者方法函数名，使用 <em>| |</em> 将参数或者方法括起来以避免歧义：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Somettimes we need |count| to be less than zero</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Remember to call |StringWithoutSpaces(&quot;foo bar baz&quot;)|</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>基本格式 (注意<code>//</code>之前和之后的空格)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">代码与注释在同一行</span><br><span class="line">- (<span class="keyword">void</span>)setTitle:(<span class="keyword">nullable</span> <span class="built_in">NSString</span> *)title forState:(<span class="built_in">UIControlState</span>)state; <span class="comment">// default is nil. title is assumed to be single line</span></span><br><span class="line"></span><br><span class="line">代码与注释分两行</span><br><span class="line"><span class="comment">// default is nil. title is assumed to be single line</span></span><br><span class="line">- (<span class="keyword">void</span>)setTitle:(<span class="keyword">nullable</span> <span class="built_in">NSString</span> *)title forState:(<span class="built_in">UIControlState</span>)state;</span><br></pre></td></tr></table></figure>

<p><code>/*</code>这种形式的注释使用<a target="_blank" rel="noopener" href="https://github.com/onevcat/VVDocumenter-Xcode">VVDocumenter</a>自动生成的格式即可</p>
<p><strong>定义在头文件里的接口方法、属性最好要有注释！</strong></p>
<h2 id="编码风格"><a href="#编码风格" class="headerlink" title="编码风格"></a><span id = "codeStyle">编码风格</span></h2><p>每个人都有自己的编码风格，这里总结了一下比较好的Cocoa编码风格和注意点</p>
<h3 id="不要使用new方法"><a href="#不要使用new方法" class="headerlink" title="不要使用new方法"></a><span id = "noNewAllowed">不要使用new方法</span></h3><p>尽管很多时候能用 <code>new</code> 代替 <code>alloc init</code> 方法，Cocoa的规范就是使用 <code>alloc init</code> 方法，使用 <code>new</code> 会让一些读者困惑。</p>
<h3 id="Public-API要尽量简洁"><a href="#Public-API要尽量简洁" class="headerlink" title="Public API要尽量简洁"></a><span id = "publicAPIBrief">Public API要尽量简洁</span></h3><p>共有接口要设计的简洁，满足核心的功能需求就可以了。不要设计很少会用到，但是参数极其复杂的API。如果要定义复杂的方法，使用类别或者类扩展。</p>
<h3 id="import-和-include"><a href="#import-和-include" class="headerlink" title="#import 和 #include"></a><span id = "importAndInclude">#import 和 #include</span></h3><p><code>#import</code> 是Cocoa中常用的引用头文件的方式，它能自动防止重复引用文件。什么时候使用 <code>#import</code>，什么时候使用 <code>#include</code> 呢？</p>
<ul>
<li><p>当引用的是一个Objective-C或者Objective-C++的头文件时，使用 <code>#import</code></p>
</li>
<li><p>当引用的是一个C或者C++的头文件时，使用 <code>#include</code> ，这时必须要保证被引用的文件提供了保护域（#define guard）<strong>这是啥？</strong></p>
</li>
</ul>
<p><em>栗子</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Cocoa/Cocoa.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;CoreFoundation/CoreFoundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;SMTFoo.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;base/basictypes.h&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>为什么不全部使用 <em>#import</em> 呢？主要是为了保证代码在不同平台间共享时不出现问题</p>
<h3 id="引用框架的根头文件"><a href="#引用框架的根头文件" class="headerlink" title="引用框架的根头文件"></a><span id = "frameworkRootHeaderFile">引用框架的根头文件</span></h3><p>每一个框架都会有一个和框架同名的头文件，它包含了框架内接口的所有引用，在使用框架的时候，应该直接引用这个头文件，而不是其它子模块的头文件，即使是你只用到了其中的一小部分，编译器会自动完成优化的</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，引用根头文件</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要单独引用框架内的其它头文件</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/NSArray.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/NSString.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="BOOL的使用"><a href="#BOOL的使用" class="headerlink" title="BOOL的使用"></a><span id = "boolUsage">BOOL的使用</span></h3><p>BOOL在Objective-C中被定义为 <code>signed char</code> 类型，这意味着一个BOOL类型的变量不仅仅可以表示 <code>YES(1)</code>和 <code>NO(0)</code>两个值，所以永远不要将BOOL类型变量直接和 <code>YES</code> 比较：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误，无法确定|great|的值是否是YES(1)，不要将BOOL值直接与YES比较</span></span><br><span class="line"><span class="built_in">BOOL</span> great = [foo isGreat];</span><br><span class="line"><span class="keyword">if</span> (great == <span class="literal">YES</span>) &#123;</span><br><span class="line">	<span class="comment">// ...be great!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="built_in">BOOL</span> great = [foo isGreat];</span><br><span class="line"><span class="keyword">if</span> (great) &#123;</span><br><span class="line">	<span class="comment">//...be great!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，也不要将其它类型的值作为BOOL来返回，这种情况下，BOOL变量只会取值的最后一个字节来赋值，这样很有可能会取到<code>0(NO)</code>。但是，一些逻辑操作符比如 <code>&amp;&amp;</code>, <code>||</code>, <code>!</code> 的返回时可以直接赋给BOOL的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误，不要将其它类型转化为BOOL返回</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isBold &#123;</span><br><span class="line">	<span class="keyword">return</span> [<span class="keyword">self</span> fontTraits] &amp; <span class="built_in">NSFontBoldTrait</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)isValid &#123;</span><br><span class="line">	<span class="keyword">return</span> [<span class="keyword">self</span> stringValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isBold &#123;</span><br><span class="line">	<span class="keyword">return</span> ([<span class="keyword">self</span> fontTraits] &amp; <span class="built_in">NSFontBoldTrait</span>) ? <span class="literal">YES</span> : <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确，逻辑操作符可以直接转化为BOOL</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isValid &#123;</span><br><span class="line">	<span class="keyword">return</span> [<span class="keyword">self</span> stringValue] != <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)isEnabled &#123;</span><br><span class="line">	<span class="keyword">return</span> [<span class="keyword">self</span> isValid] &amp;&amp; [<span class="keyword">self</span> isBold];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外BOOL类型可以和 <em>_Bool</em>, <em>bool</em> 相互转化， 但是不能和 <em>Boolean</em> 转化</p>
<h3 id="在init和dealloc中不要用存取方法访问实例变量"><a href="#在init和dealloc中不要用存取方法访问实例变量" class="headerlink" title="在init和dealloc中不要用存取方法访问实例变量"></a><span id = "noInstanceVarInInitAndDealloc">在init和dealloc中不要用存取方法访问实例变量</span></h3><p>当 <code>init</code> 和 <code>dealloc</code> 方法被执行时，类的运行时环境不是处于正常状态，使用存取方法访问变量可能会导致不可预料的结果，因此应该在两个方法内直接访问实例变量</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，直接访问实例变量</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">	<span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	_bar = [[SMTBar alloc] init];</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要通过存取方法访问</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">	<span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">	   <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">self</span>.bar = [[SMTBar alloc] init];</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="if-else"><a href="#if-else" class="headerlink" title="if-else"></a><span id = "if-else">if-else</span></h3><p>不管<code>if</code>或者<code>else</code>中的代码块有多少，都应该放在 <code>&#123;&#125;</code> 中</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="keyword">if</span> (!condition) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误</span></span><br><span class="line"><span class="keyword">if</span> (!condition)</span><br><span class="line">    <span class="keyword">return</span>;</span><br></pre></td></tr></table></figure>

<p>if-else 超过4层的时候，就要考虑重构，多层的if-else结构很难维护</p>
<p>当需要一定条件下才执行某项操作时，最左边的应该是最重要的代码，不要将最重要的代码内嵌到<code>if</code>中</p>
<p><span id = "returnInInit">此原则同样适用于<code>init</code>方法中</span></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 良好的风格</span></span><br><span class="line">- (<span class="keyword">void</span>)someMethod &#123;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重要的代码写在这里</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// do other initializing things</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不提倡的风格</span></span><br><span class="line">- (<span class="keyword">void</span>)someMethod &#123;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="comment">// 重要的代码</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span id = "if-else-else-format">else</span>紧跟在if块的右 <em>}</em> 之后，不要另起一行</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 良好的风格</span></span><br><span class="line">- (<span class="keyword">void</span>)someMethod &#123;</span><br><span class="line">    <span class="keyword">if</span> (condition1) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (condition2) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不提倡的风格</span></span><br><span class="line">- (<span class="keyword">void</span>)someMethod &#123;</span><br><span class="line">    <span class="keyword">if</span> (condition1) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (condition2) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="保证NSString在赋值时被复制"><a href="#保证NSString在赋值时被复制" class="headerlink" title="保证NSString在赋值时被复制"></a><span id = "NSStringCopy">保证NSString在赋值时被复制</span></h3><p><code>NSString</code> 非常常用，在它被传递或者赋值时应该保证是以复制<code>（copy）</code>的方式进行的，这样可以防止在不知情的情况下String的值被其他对象修改</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setFoo:(<span class="built_in">NSString</span> *)aFoo &#123;</span><br><span class="line">	_foo = [aFoo <span class="keyword">copy</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用NSNumber的语法糖"><a href="#使用NSNumber的语法糖" class="headerlink" title="使用NSNumber的语法糖"></a><span id = "NSNumberUsage">使用NSNumber的语法糖</span></h3><p>使用带有 <em>@</em> 符号的语法糖来生产NSNumber对象能使代码更简洁：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSNumber</span> *fortyTwo = @<span class="number">42</span></span><br><span class="line"><span class="built_in">NSNumber</span> *piOverTwo = @(M_PI / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">	kMyEnum = <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">NSNumber</span> *myNumber = @(kMyEnum);</span><br></pre></td></tr></table></figure>

<h3 id="nil检查"><a href="#nil检查" class="headerlink" title="nil检查"></a><span id = "nilCheck">nil检查</span></h3><p>因为在Objective-C中向nil对象发送命令是不会抛出异常或者导致崩溃的，只是完全的『什么都不干』，所以，只在程序中使用nil来做逻辑上的检查。</p>
<p>另外，不要使用诸如 <code>nil == Object</code> 或者 <code>Object == nil</code> 的形式来判断</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，直接判断</span></span><br><span class="line"><span class="keyword">if</span> (!objc) &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要使用 nil == Object 的形式</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">nil</span> == objc) &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果参数不允许为<code>nil</code>，则使用<code>NSAssert</code>断言处理。<code>NSAssert</code>是系统定义的宏</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSAssert</span>(param != <span class="literal">nil</span>, <span class="string">@&quot;param参数为空&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="属性的线程安全"><a href="#属性的线程安全" class="headerlink" title="属性的线程安全"></a><span id = "threadSafe">属性的线程安全</span></h3><p>定义一个属性时，编译器会自动生成线程安全的存取方法<code>（Atomic）</code>，但这样会大大降低性能，特别是对于那些需要频繁存取的属性来说，是极大的浪费。所以如果定义的属性不需要线程保护，记得手动添加属性关键字 <code>nonatomic</code> 来取消编译器的优化</p>
<h3 id="点分语法的使用"><a href="#点分语法的使用" class="headerlink" title="点分语法的使用"></a><span id = "dotNotation">点分语法的使用</span></h3><h3 id="Delegate要使用弱引用"><a href="#Delegate要使用弱引用" class="headerlink" title="Delegate要使用弱引用"></a><span id = "delegateWeak">Delegate要使用弱引用</span></h3><p>一个类的Delegate对象通常还引用着类本身，这样很容易造成引用循环的问题，所以类的Delegate属性要设置为弱引用</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;MyDelegate&gt; delegate;</span><br></pre></td></tr></table></figure>

<h3 id="block判空处理"><a href="#block判空处理" class="headerlink" title="block判空处理"></a><span id = "checkBlockNil">block判空处理</span></h3><p>不论任何时候，调用bloc时一定要做判空处理</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，调用block之前做了判空处理</span></span><br><span class="line">- (<span class="keyword">void</span>)fetchUserInfoWithCompletionHandler:(<span class="keyword">void</span>(^)(SMTUser *user))completionHandler &#123;</span><br><span class="line">	SMTUser *user = <span class="literal">nil</span>;</span><br><span class="line">	<span class="comment">// fetch user ...</span></span><br><span class="line">	<span class="keyword">if</span> (completionHandler) &#123;</span><br><span class="line">		completionHandler(user);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，调用block之前未做判空处理</span></span><br><span class="line">- (<span class="keyword">void</span>)fetchUserInfoWithCompletionHandler:(<span class="keyword">void</span>(^)(SMTUser *user))completionHandler &#123;</span><br><span class="line">	SMTUser *user = <span class="literal">nil</span>;</span><br><span class="line">	<span class="comment">// fetch user ...</span></span><br><span class="line">	completionHandler(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="集合的遍历"><a href="#集合的遍历" class="headerlink" title="集合的遍历"></a><span id = "collectionTraverse">集合的遍历</span></h3><p>尽量避免使用 <code>for(int i = 0; i &lt; count; i++)</code> 的形式</p>
<h4 id="NSArray的遍历"><a href="#NSArray的遍历" class="headerlink" title="NSArray的遍历"></a><span id = "NSArrayTraverse">NSArray的遍历</span></h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果不需要index，使用 for-each 进行数组遍历</span></span><br><span class="line"><span class="keyword">for</span> (SMTFoo *foo <span class="keyword">in</span> foos) &#123;</span><br><span class="line">	<span class="comment">// do anything with |foo|</span></span><br><span class="line">	<span class="comment">// BUT NEVER do [foos removeObject:] !</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果需要index，是用block遍历</span></span><br><span class="line">[foos enumerateObjectsUsingBlock:^(SMTFoo *foo, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> *stop) &#123;</span><br><span class="line">	<span class="comment">// do anything with |foo|</span></span><br><span class="line">	<span class="comment">// BUT NEVER do [foos removeObject:] !</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h4 id="NSDictionary的遍历"><a href="#NSDictionary的遍历" class="headerlink" title="NSDictionary的遍历"></a><span id = "NSDictionaryTraverse">NSDictionary的遍历</span></h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[dict enumerateKeysAndObjectsUsingBlock:^(<span class="keyword">id</span> key, <span class="keyword">id</span> obj, <span class="built_in">BOOL</span> *stop) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a><span id = "switch">switch</span></h3><ol>
<li>每一个<code>case</code>下始终都要有<code>&#123;&#125;</code>, 不管该<code>case</code>下有几行代码</li>
<li><code>break;</code>要在<code>&#123;&#125;</code>里</li>
<li><code>default</code>必须要有且<code>default</code>块中要有<code>break;</code></li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 推荐对写法</span></span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> type1: &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> type2: &#123;</span><br><span class="line">        <span class="comment">// do somthing</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> type3: &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>: &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不推荐对写法</span></span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> type1:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> type2:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do somthing</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> type3:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a><span id = "todo">TODO</span></h3><p>基本格式</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TODO(who): what to do</span></span><br></pre></td></tr></table></figure>

<p>标记TODO的地方一定要去do！do了以后把TODO标记删掉！</p>
<h3 id="More-tips"><a href="#More-tips" class="headerlink" title="More tips"></a><span id = "moreTips">More tips</span></h3><ul>
<li><p>尽量减少在代码中之间使用数字常量，每个数字都有含义，使用常量定义等方式表明数字含义</p>
</li>
<li><p>尽量减少代码中的重复计算，比如代码中多处要使用屏幕宽度，然后计算<code>[[UIScreen mainScreen] bounds].size.width</code>，很多次，显得很繁琐，代码冗长。不如直接使用宏定义：</p>
<blockquote>
<p>#define SCREEN_WIDTH ([[UIScreen mainScreen] bounds].size.width)</p>
</blockquote>
</li>
<li><p>宏定义全部字母<strong>大写</strong></p>
</li>
<li><p>任何一个单独的 <em>=</em> 两边都要空一个空格</p>
</li>
</ul>
<h2 id="文件的组织"><a href="#文件的组织" class="headerlink" title="文件的组织"></a><span id = "fileOrganization">文件的组织</span></h2><p>尽量保证一个类一个文件，这样可以有效控制文件大小</p>
<pre><code>- Mail
    | - Home
        | - ViewController
        | - View
            | - Cell
            | - TableView
            | - ...
        | - Model
        | - Proxy
        | - ViewModel/Service
        | - Helper/Util
    | - NewMail
    | - MailDetail
    | - Biz
        | - Manager
        | - Supporting Files
            | - Ace
            | - DB
</code></pre>
<h2 id="代码块的组织"><a href="#代码块的组织" class="headerlink" title="代码块的组织"></a><span id = "codeOrganization">代码块的组织</span></h2><p>在我们平时的开发工作中，看代码的时间不比写代码的时候少，所以如何让自己写的代码文件『好看』是非常重要的。</p>
<p>我们应该对文件中的各种方法按照功能进行分块，同时尽量保证一个类的代码行数不超过__500__行</p>
<p>可以使用<code>#pragma mark</code>宏辅助进行方法分块：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Life Cycle</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Public Interface</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UI Actions</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Business Logic</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UITableViewDataSource</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UITableViewDelegate</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UIScrollViewDelegate</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Notification Handler</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Private Method</span></span><br></pre></td></tr></table></figure>

<h2 id="方法-函数的规模"><a href="#方法-函数的规模" class="headerlink" title="方法/函数的规模"></a><span id = "methodScale">方法/函数的规模</span></h2><p>一个方法或者一个函数不应超过__50__行，最多不应超过100行。一个方法应该只做一件事，一般来讲50行是够的。如果方法行数太长，应该考虑将其中的某些地方做成子函数使用。</p>
<p>函数的参数不应该多余5个，如果一个函数参数多余5个，则需考虑重构</p>
<p>子函数内不应调用成员变量 (待定)</p>
<p><strong>严禁复制代码</strong></p>
<p>如果我们在编码的时候做了任何一个copy-paste代码的动作，证明我们paste的代码是可以抽象成子函数的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shinemoidev.github.io/2018/02/06/2018-02-06-ShineMo-Objective-C-Style-Guid/" data-id="ckx4bakdc0003k1hv7iuzeotx" data-title="讯盟 Objective-C 代码规范" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" rel="tag">代码规范</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/02/28/2018-02-28-IntrinsicContentSize-AutoLayout/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Neuer</strong>
      <div class="article-nav-title">
        
          IntrinsicContentSize 与 AutoLayout 的使用剖析
        
      </div>
    </a>
  
  
    <a href="/2018/01/22/team-blog-install-tutorial/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Älter</strong>
      <div class="article-nav-title">Team blog install tutorial</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9B%A2%E9%98%9F/">团队</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI%E7%BB%84%E4%BB%B6/" rel="tag">UI组件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/block/" rel="tag">block</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/doc/" rel="tag">doc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hook/" rel="tag">hook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/" rel="tag">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" rel="tag">代码规范</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B-ReactiveObjc/" rel="tag">函数式编程 ReactiveObjc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E4%BB%B6/" rel="tag">组件</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/UI%E7%BB%84%E4%BB%B6/" style="font-size: 20px;">UI组件</a> <a href="/tags/block/" style="font-size: 10px;">block</a> <a href="/tags/doc/" style="font-size: 10px;">doc</a> <a href="/tags/hook/" style="font-size: 10px;">hook</a> <a href="/tags/iOS/" style="font-size: 16.67px;">iOS</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 10px;">代码规范</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 13.33px;">其他</a> <a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B-ReactiveObjc/" style="font-size: 10px;">函数式编程 ReactiveObjc</a> <a href="/tags/%E7%BB%84%E4%BB%B6/" style="font-size: 20px;">组件</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/13/SwiftUI-%E4%B8%8E-UIKit-%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91%E7%AE%80%E8%BF%B0/">SwiftUI 与 UIKit 混合开发简述</a>
          </li>
        
          <li>
            <a href="/2021/12/03/ios-tips/">iOS Tips</a>
          </li>
        
          <li>
            <a href="/2019/10/09/2019-10-09-iOS-Crash-%E5%88%86%E6%9E%90/">iOS Crash 分析</a>
          </li>
        
          <li>
            <a href="/2019/01/11/2019-01-11-Xcode-LLDB/">Xcode中使用LLDB调试</a>
          </li>
        
          <li>
            <a href="/2018/11/13/2018-11-13-private-pod/">做一个自己的私有pod</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 ShineMo iOS Dev Team<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>